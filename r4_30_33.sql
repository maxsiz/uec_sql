--r4
SELECT SUBSTR(T.CARD_NUM,2) as NUM, O.CODE as CARRIER, count (*) as TRIP_COUNT
,T.AMOUNT AS TARIF
, decode(R.ID_CODE_MSG,200001000,1,0) as VID
--, T.*
 FROM CPTT.T_DATA T
    INNER JOIN CPTT.DIVISION D ON T.ID_DIVISION=D.ID
    INNER JOIN CPTT.OPERATOR O ON D.ID_OPERATOR=O.ID  and O.ROLE=1
    INNER JOIN CPTT.ROUTE R ON T.id_route=R.ID AND T.id_division = R.id_division
 WHERE 
     T.CARD_SERIES  in (30,33) 
     and O.CODE in ('0002','0003','0004','0005','0006','0007','0008','0009','0011','0012','0013','0014','0015','0016','0017','0018','0019','0020','0021','0022','0023','0024','0025','0026','0027','0062')  
AND   T.KIND=16 
AND TO_CHAR(TRUNC(T.DATE_OF,'MM'), 'DDMMYYYY') = '01032016'
GROUP BY SUBSTR(T.CARD_NUM,2), O.CODE, T.AMOUNT, decode(R.ID_CODE_MSG,200001000,1,0) 
ORDER BY decode(R.ID_CODE_MSG,200001000,1,0),O.CODE, T.AMOUNT, SUBSTR(T.CARD_NUM,2) 



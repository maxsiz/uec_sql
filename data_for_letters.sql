Select R2.*, R3.tickets_83, R3.TRIPS_83 FROM (
SELECT MAX(R1.ID) as ID, R1.NAME, SUM(kol_p_30) as kol_p_30, SUM(kol_p_33) as kol_p_33, SUM(kol_p_83) as kol_p_83
FROM (
SELECT 
D.ID, D.NAME,
--, T.card_series,
CASE
  WHEN T.card_series = 30 THEN 1
  ELSE 0
END as kol_p_30,
CASE
  WHEN T.card_series = 33 THEN 1
  ELSE 0
END as kol_p_33,
CASE
  WHEN T.card_series = 83 THEN 1
  ELSE 0
END as kol_p_83
FROM CPTT.T_DATA T
    INNER JOIN CPTT.DIVISION D ON T.ID_DIVISION=D.ID
    INNER JOIN CPTT.OPERATOR O ON D.ID_OPERATOR=O.ID  and O.ROLE=1
    --INNER JOIN CPTT.ROUTE R ON T.id_route=R.ID AND T.id_division = R.id_division
 WHERE 
     TO_CHAR(TRUNC(T.DATE_OF,'MM'), 'DDMMYYYY') = '01022016'--!!!!CHANGE DATE
     and O.CODE in ('0002','0003','0004','0005','0006','0007','0008','0009','0011','0012','0013','0014','0015','0016','0017','0018','0019','0020','0021','0022','0023','0024','0025','0026','0027','0062')  
     AND T.CARD_SERIES  in (30,33,83) 
     AND  (T.KIND=16 OR T.KIND=17 OR T.KIND=18 OR T.KIND=19) 
     ) R1
     GROUP BY R1.NAME
) R2 INNER JOIN (     
SELECT R.ID, count(*) as tickets_83, SUM(kol_t) as TRIPS_83 FROM (
SELECT D.ID, T.CARD_NUM, count (*) as kol_t
 FROM CPTT.T_DATA T
    INNER JOIN CPTT.DIVISION D ON T.ID_DIVISION=D.ID
    INNER JOIN CPTT.OPERATOR O ON D.ID_OPERATOR=O.ID  and O.ROLE=1
 WHERE 
     T.CARD_SERIES  in (83) 
     and O.CODE in ('0002','0003','0004','0005','0006','0007','0008','0009','0011','0012','0013','0014'
                    ,'0015','0016','0017','0018','0019','0020','0021','0022','0023','0024','0025','0026','0027','0062')  
AND   T.KIND=17 
AND TO_CHAR(TRUNC(T.DATE_OF,'MM'), 'DDMMYYYY') = '01022016'--!!!!CHANGE DATE
GROUP BY D.ID, T.CARD_NUM
) R
GROUP BY R.ID
) R3 ON R3.ID=R2.ID
